/*
 * Copyright (C) Contributors to the Suwayomi project
 * 
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/. */

body {
    margin: 0;
}

:root {
    --ocr-accent: #4890ff;
    --ocr-bg: #ffffff;
    --ocr-text-color: #000000;
    --ocr-opacity: 0.3;
    --ocr-scale: 1.05;
}

/* --- SCROLLING LOGIC --- */

/* 1. Default State: Allow scrolling normally */
html, body {
    margin: 0;
    padding: 0;
}

/* 2. Reader Mode Lock: Only applied when viewing a chapter */
html.ocr-reader-mode, 
html.ocr-reader-mode body {
    /* This stops the window from scrolling, forcing the App's internal div to handle it */
    overflow: hidden !important;
    height: 100%;
}

/* --- REST OF CSS (Unchanged) --- */
/* ... (Overlay Container, TextBox, Modal styles remain the same) ... */
.ocr-overlay-container { pointer-events: none; z-index: 99999; }

/* --- TEXT BOX CARD STYLING --- */
.gemini-ocr-text-box {
    position: absolute;
    
    /* Flexbox Alignment (Top-Left/Top-Right logic) */
    display: flex;
    flex-direction: row; 
    
    align-items: flex-start; 
    justify-content: center; 
    
    /* Visuals */
    border-radius: 3px;
    background-color: var(--ocr-bg);
    border: 1px solid #ccc;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    color: var(--ocr-text-color);
    
    /* Interaction */
    cursor: text;
    user-select: text !important;
    pointer-events: auto !important;
    
    /* Typography */
    font-family: 'Noto Sans JP', sans-serif;
    font-weight: 600;
    line-height: 1.1; 
    text-align: center;
    
    /* Layout */
    overflow: visible; 
    white-space: pre;  
    box-sizing: border-box; 
    padding: 4px;
    
    min-width: 20px;
    min-height: 20px;
    
    transition: opacity 0.2s, transform 0.1s;
    opacity: 1; 
}

/* --- VERTICAL TEXT SPECIFIC --- */
.gemini-ocr-text-box.vertical {
    writing-mode: vertical-rl;
    text-orientation: upright;
    
    justify-content: flex-start; 
    align-items: center;         
    text-align: left; 
}

/* --- HOVER STATE --- */
.gemini-ocr-text-box:hover {
    z-index: 100000;
    transform: scale(var(--ocr-scale));
    border: 2px solid var(--ocr-accent);
    padding: 3px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    opacity: 1 !important; 
}

/* --- EDIT MODE --- */
.gemini-ocr-text-box.editing {
    z-index: 200000 !important;
    background: white !important;
    border: 2px solid #3498db;
    overflow: auto; 
    scrollbar-width: none;
    -ms-overflow-style: none;
    
    padding: 4px;
    
    justify-content: flex-start;
    align-items: flex-start;
    text-align: left;
    
    opacity: 1 !important; 
}

.gemini-ocr-text-box.editing::-webkit-scrollbar {
    display: none;
}

.gemini-ocr-text-box.merge-target {
    outline: 3px solid #f1c40f;
    z-index: 100000;
    opacity: 1 !important; 
}

/* --- SOLO MODE LOGIC --- */
.ocr-overlay-container.solo-mode .gemini-ocr-text-box {
    opacity: 0;
}

.ocr-overlay-container.solo-mode .gemini-ocr-text-box:hover {
    opacity: 1 !important; 
}

/* --- MODAL STYLES (Unchanged) --- */
.ocr-modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); z-index: 2147483647; display: flex; align-items: center; justify-content: center; padding: 20px; }
.ocr-modal { background: #1a1d21; color: #eaeaea; width: 600px; max-width: 95vw; max-height: 85vh; border: 1px solid var(--ocr-accent); box-shadow: 0 10px 25px rgba(0,0,0,0.5); display: flex; flex-direction: column; }
.ocr-modal-header { padding: 15px 20px; border-bottom: 1px solid #333; flex-shrink: 0; }
.ocr-modal-content { padding: 20px; flex-grow: 1; overflow-y: auto; min-height: 0; }
.ocr-modal-footer { padding: 15px 20px; border-top: 1px solid #333; background: #15171a; display: flex; justify-content: flex-end; gap: 10px; flex-shrink: 0; }
.ocr-modal .grid { display: grid; grid-template-columns: 120px 1fr; gap: 10px 15px; margin-bottom: 20px; align-items: center; }
.ocr-modal input, .ocr-modal select, .ocr-modal textarea { background: #2a2a2e; color: white; border: 1px solid #555; padding: 8px; width: 100%; box-sizing: border-box; }
.ocr-controls { position: fixed; bottom: 20px; right: 20px; display: flex; gap: 10px; z-index: 99999; }
.ocr-controls button { width: 50px; height: 50px; border-radius: 50%; font-size: 24px; cursor: pointer; background: #2a2a2e; color: white; border: 1px solid #555; display: flex; align-items: center; justify-content: center;}
.ocr-modal-footer button { padding: 8px 16px; border-radius: 4px; border: 1px solid #444; background: #2a2a2e; color: white; cursor: pointer; }
.ocr-modal-footer button.primary { background-color: #27ae60; border-color: #219150; }
.ocr-modal-footer button.danger { background-color: #c0392b; border-color: #a93226; }
.ocr-modal-footer button.warning { background-color: #e67e22; border-color: #d35400; }
.mobile-mode .gemini-ocr-text-box { transition: none !important; animation: none !important; }

/* --- STATUS ICON --- */
.ocr-status-icon-container {
    position: absolute;
    top: 15px;   
    right: 15px;  
    z-index: 200000; 
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.9);  
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    pointer-events: auto; 
    transition: opacity 0.3s;
}

.ocr-retry-button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
}

.ocr-retry-button:hover {
    transform: scale(1.15);
}

.ocr-retry-button svg {
    width: 20px;
    height: 20px;
}

/* Spinner Animation */
.ocr-spinner {
    animation: rotate 2s linear infinite;
    width: 20px;
    height: 20px;
}

.ocr-spinner .path {
    stroke: var(--ocr-accent);
    stroke-linecap: round;
    animation: dash 1.5s ease-in-out infinite;
}

@keyframes rotate {
    100% { transform: rotate(360deg); }
}

@keyframes dash {
    0% { stroke-dasharray: 1, 150; stroke-dashoffset: 0; }
    50% { stroke-dasharray: 90, 150; stroke-dashoffset: -35; }
    100% { stroke-dasharray: 90, 150; stroke-dashoffset: -124; }
}

/* Chapter Process Buttons */
.ocr-chapter-btn {
    font-family: 'Roboto', sans-serif;
    font-size: 0.75rem;
    font-weight: 500;
    padding: 4px 12px;
    border-radius: 4px;
    border: 1px solid;
    cursor: pointer;
    transition: all 0.2s;
    background: transparent;
    text-transform: uppercase;
    line-height: 1.5;
}

.ocr-chapter-btn.process {
    color: var(--ocr-accent);
    border-color: var(--ocr-accent);
}

.ocr-chapter-btn.process:hover {
    background-color: rgba(72, 144, 255, 0.1);
}

.ocr-chapter-btn.process.busy {
    opacity: 0.7;
    cursor: wait;
}

.ocr-chapter-btn.done {
    color: #27ae60;
    border-color: #27ae60;
    background-color: rgba(39, 174, 96, 0.1);
    cursor: default;
}

.ocr-chapter-btn.loading {
    border: none;
    color: #888;
}
